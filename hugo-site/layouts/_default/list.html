{{ define "main" }}
<article class="markdown book-article">
  <h1>{{ .Title }}</h1>

  {{ with .Content }}
    {{ . }}
  {{ end }}

  {{/* .RegularPagesRecursive collects all leaf pages in the entire subtree */}}
  {{ $all := sort .RegularPagesRecursive ".Date" "desc" }}

  {{ if $all }}
  <div class="post-card-grid">
    {{ range $all }}
      {{ if not .Params.bookHidden }}
      <a class="post-card" href="{{ .RelPermalink }}">
        <div class="post-card-meta">
          <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "2006-01-02" }}</time>
          {{ with .Params.categories }}
            · {{ range $i, $c := . }}{{ if $i }}, {{ end }}{{ $c }}{{ end }}
          {{ end }}
        </div>
        <h3 class="post-card-title">{{ .Title }}</h3>
        {{ if .Summary }}
        <p class="post-card-summary">{{ .Summary | plainify | truncate 100 }}</p>
        {{ end }}
        {{ with .Params.tags }}
        <div class="post-card-tags">
          {{ range first 3 . }}<span class="post-card-tag">{{ . }}</span>{{ end }}
        </div>
        {{ end }}
      </a>
      {{ end }}
    {{ end }}
  </div>
  {{ else }}
  <p>아직 작성된 글이 없습니다.</p>
  {{ end }}
</article>
{{ end }}
