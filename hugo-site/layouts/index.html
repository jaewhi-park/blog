{{ define "main" }}
<article class="markdown book-article">
  {{- .Content -}}

  <hr>

  <h2>Recent Posts</h2>
  <div class="post-card-grid">
    {{ $pages := where .Site.RegularPages "Kind" "page" }}
    {{ $posts := where $pages ".File.Path" "ne" "" }}
    {{ range first 10 (sort $posts ".Date" "desc") }}
      {{ if not .Params.bookHidden }}
      <a class="post-card" href="{{ .RelPermalink }}">
        <div class="post-card-meta">
          <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "2006-01-02" }}</time>
          {{ with .Params.categories }}
            Â· {{ range $i, $c := . }}{{ if $i }}, {{ end }}{{ $c }}{{ end }}
          {{ end }}
        </div>
        <h3 class="post-card-title">{{ .Title }}</h3>
        {{ if .Summary }}
        <p class="post-card-summary">{{ .Summary | plainify | truncate 100 }}</p>
        {{ end }}
        {{ with .Params.tags }}
        <div class="post-card-tags">
          {{ range first 3 . }}<span class="post-card-tag">{{ . }}</span>{{ end }}
        </div>
        {{ end }}
      </a>
      {{ end }}
    {{ end }}
  </div>
</article>
{{ end }}
